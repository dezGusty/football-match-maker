<app-header></app-header>

<table class="players-table">
  <thead>
    <tr>
      <th>#</th>
      <th>First name</th>
      <th>Last name</th>
      <th>Rating</th>
      <th>Status</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let player of players; let i = index" [class.disabled-player]="!isPlayerEnabled(player)">
      <td>{{ i+1 }}</td>
      <ng-container *ngIf="editIndex === i && isPlayerEnabled(player); else viewMode">
        <td><input type="text" [(ngModel)]="editedPlayer!.firstName" /></td>
        <td><input type="text" [(ngModel)]="editedPlayer!.lastName" /></td>
        <td><input type="number" [(ngModel)]="editedPlayer!.rating" /></td>
        <td><span class="status-badge enabled">Active</span></td>
        <td>
          <button class="action-btn save-btn" title="Save" (click)="editPlayer()">Save</button>
          <button class="action-btn cancel-btn" title="Cancel" (click)="clearEditIndex()">Cancel</button>
        </td>
      </ng-container>
      <ng-template #viewMode>
        <td>{{ player.firstName }}</td>
        <td>{{ player.lastName }}</td>
        <td>{{ player.rating }}</td>
        <td>
          <span class="status-badge" [class.enabled]="isPlayerEnabled(player)"
            [class.disabled]="!isPlayerEnabled(player)">
            {{ isPlayerEnabled(player) ? 'Active' : 'Disabled' }}
          </span>
        </td>
        <td>
          <ng-container *ngIf="isPlayerEnabled(player)">
            <button class="action-btn edit-btn" title="Edit" (click)="setEditIndex(i)">Edit</button>
            <button class="action-btn delete-btn" title="Delete" (click)="deletePlayer(player.id!, i)">Delete</button>
          </ng-container>
          <ng-container *ngIf="!isPlayerEnabled(player)">
            <button class="action-btn enable-btn" title="Reactivate Player"
              (click)="enablePlayer(player.id!)">Reactivate</button>
          </ng-container>
        </td>
      </ng-template>
    </tr>
  </tbody>
</table>

<button class="open-modal-btn" (click)="showAddModal = true">Add New Player</button>

@if (showAddModal) {
<div class="modal-backdrop">
  <div class="modal-content">
    <button class="close-modal-btn" (click)="showAddModal = false" title="Close">&times;</button>
    <h3>Add New Player</h3>
    <input type="text" placeholder="First Name" [(ngModel)]="newPlayer.firstName" />
    <input type="text" placeholder="Last Name" [(ngModel)]="newPlayer.lastName" />
    <input type="number" placeholder="Rating" [(ngModel)]="newPlayer.rating" />
    <button (click)="addPlayer(); showAddModal = false">Add Player</button>
  </div>
</div>
}